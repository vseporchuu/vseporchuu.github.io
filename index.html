<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AnimeHub</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            background-color: #2D2D2D;
            color: white;
            padding: 16px;
        }

        body.light-theme {
            background-color: #f5f5f5;
            color: #333;
        }

        body.dark-theme {
            background-color: #121212;
            color: #e0e0e0;
        }

        /* Общие стили для страниц */
        .page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #2D2D2D;
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }

        .page.active {
            display: block;
        }

        .page-header {
            display: flex;
            align-items: center;
            margin-bottom: 24px;
        }

        .back-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.5);
            cursor: pointer;
            margin-right: 12px;
        }

        .page-title {
            font-size: 24px;
            font-weight: bold;
        }

        /* Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            cursor: pointer;
        }

        .search-icon {
            width: 24px;
            height: 24px;
            cursor: pointer;
        }

        /* Центральное меню */
        .center-menu {
            position: fixed;
            top: -100%;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 400px;
            background: #3A3A3A;
            border-radius: 16px;
            padding: 20px;
            z-index: 1000;
            transition: all 0.3s ease;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
        }

        .center-menu.active {
            top: 80px;
        }

        .user-info {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #444;
        }

        .user-info img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-right: 15px;
        }

        .menu-items {
            list-style: none;
        }

        .menu-items li {
            padding: 16px 0;
            border-bottom: 1px solid #444;
            text-align: center;
            cursor: pointer;
        }

        .menu-items li:last-child {
            border-bottom: none;
        }

        /* Горизонтальный скролл */
        .hero {
            margin-bottom: 8px;
            position: relative;
        }

        .horizontal-scroll {
            display: flex;
            overflow-x: auto;
            gap: 12px;
            padding-bottom: 4px;
            scrollbar-width: none;
            scroll-snap-type: x mandatory;
        }

        .horizontal-scroll::-webkit-scrollbar {
            display: none;
        }

        .featured-card {
            min-width: 100%;
            scroll-snap-align: start;
            position: relative;
        }

        .featured-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
        }

        .featured-info {
            padding: 6px 0;
        }

        .featured-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .featured-rating {
            font-size: 12px;
            color: #FFD700;
        }

        .status-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #FF6B81;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }

        .dots-container {
            display: flex;
            justify-content: center;
            gap: 6px;
            margin-top: 0;
            margin-bottom: 4px;
        }

        .dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #444;
            cursor: pointer;
        }

        .dot.active {
            background: #FF6B81;
        }

        /* Вертикальный список */
        .vertical-list {
            margin-top: 16px;
        }

        .anime-card {
            display: flex;
            margin-bottom: 16px;
        }

        .anime-poster {
            width: 100px;
            height: 140px;
            object-fit: cover;
            border-radius: 8px;
        }

        .anime-content {
            padding: 0 12px;
            flex: 1;
            overflow: hidden;
        }

        .anime-title {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .anime-genre {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 8px;
        }

        .genre-tag {
            background: #444;
            padding: 3px 6px;
            border-radius: 12px;
            font-size: 10px;
        }

        .anime-description {
            font-size: 12px;
            color: #BBBBBB;
            margin-bottom: 10px;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .watch-btn {
            background: #FF6B81;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            font-size: 12px;
        }

        /* Страница деталей */
        .detail-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #2D2D2D;
            z-index: 2000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            overflow-y: auto;
        }

        .detail-page.active {
            transform: translateX(0);
        }

        .detail-header {
            position: relative;
            height: 360px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .detail-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            filter: blur(8px);
            opacity: 0.8;
            z-index: 1;
            mask-image: linear-gradient(to bottom, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.5) 50%, transparent 100%);
            -webkit-mask-image: linear-gradient(to bottom, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.5) 50%, transparent 100%);
        }

        .detail-cover {
            position: relative;
            z-index: 2;
            width: 80%;
            max-height: 300px;
            object-fit: contain;
            margin: 0 auto;
            border-radius: 8px;
        }

        .detail-actions {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 3;
        }

        .back-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.5);
            cursor: pointer;
        }

        .bookmark-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 3;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.5);
            cursor: pointer;
        }

        .bookmark-menu {
            position: absolute;
            top: 60px;
            right: 20px;
            background: #3A3A3A;
            border-radius: 12px;
            padding: 10px 0;
            z-index: 4;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            display: none;
        }

        .bookmark-menu.active {
            display: block;
        }

        .bookmark-option {
            padding: 10px 20px;
            cursor: pointer;
            white-space: nowrap;
        }

        .bookmark-option:hover {
            background: #444;
        }

        .detail-body {
            padding: 20px;
            position: relative;
            z-index: 2;
            text-align: center;
            background: #2D2D2D;
        }

        .detail-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 4px;
        }

        .detail-subtitle {
            color: #BBBBBB;
            font-style: italic;
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            gap: 8px;
        }

        .detail-year {
            color: #BBBBBB;
        }

        .detail-eng-title {
            color: #BBBBBB;
        }

        .tabs-container {
            background: #3A3A3A;
            border-radius: 30px;
            padding: 6px;
            margin-bottom: 20px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .tabs {
            display: flex;
            justify-content: space-around;
        }

        .tab {
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .tab.active {
            background: #FF6B81;
            color: white;
        }

        .tab-content {
            display: none;
            max-width: 600px;
            margin: 0 auto;
        }

        .tab-content.active {
            display: block;
        }

        .info-item {
            margin-bottom: 16px;
            text-align: left;
        }

        .info-label {
            color: #BBBBBB;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .info-value {
            font-size: 16px;
        }

        .tag {
            display: inline-block;
            background: #444;
            padding: 6px 12px;
            border-radius: 16px;
            margin-right: 8px;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .voice-tag {
            display: inline-block;
            background: #444;
            padding: 6px 12px;
            border-radius: 16px;
            margin-right: 8px;
            margin-bottom: 8px;
            font-size: 14px;
            cursor: pointer;
            text-decoration: none;
            color: white;
        }

        .voice-tag:hover {
            background: #555;
        }

        .watch-btn-large {
            background: #FF6B81;
            color: white;
            border: none;
            padding: 14px;
            border-radius: 8px;
            width: 100%;
            max-width: 300px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            margin-left: auto;
            margin-right: auto;
            display: block;
        }

        .episodes-list {
            text-align: left;
            margin-top: 20px;
        }

        .episode-item {
            padding: 12px;
            background: #3A3A3A;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
        }

        .episode-item:hover {
            background: #444;
        }

        /* Рейтинг */
        .rating-container {
            text-align: center;
            padding: 20px 0;
        }

        .rating-value {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .rating-count {
            color: #BBBBBB;
            margin-bottom: 20px;
        }

        .stars-container {
            display: flex;
            justify-content: center;
            gap: 4px;
            margin-bottom: 20px;
        }

        .star {
            font-size: 24px;
            color: #444;
            cursor: pointer;
        }

        .star.active {
            color: #FFD700;
        }

        .rating-chart {
            margin-top: 20px;
        }

        .chart-row {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .chart-label {
            width: 40px;
            font-size: 14px;
        }

        .chart-bar-container {
            flex: 1;
            height: 12px;
            background: #444;
            border-radius: 6px;
            overflow: hidden;
        }

        .chart-bar {
            height: 100%;
            background: #FF6B81;
            border-radius: 6px;
        }

        .chart-value {
            width: 40px;
            text-align: right;
            font-size: 14px;
        }

        /* Комментарии */
        .comments-container {
            margin-top: 20px;
        }

        .comment {
            background: #3A3A3A;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .comment-header {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .comment-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 12px;
        }

        .comment-user {
            font-weight: bold;
            margin-bottom: 4px;
        }

        .comment-date {
            color: #BBBBBB;
            font-size: 12px;
        }

        .comment-text {
            line-height: 1.4;
            margin-bottom: 12px;
        }

        .comment-actions {
            display: flex;
            gap: 16px;
        }

        .comment-action {
            display: flex;
            align-items: center;
            color: #BBBBBB;
            font-size: 14px;
            cursor: pointer;
        }

        .comment-form {
            margin-top: 24px;
            background: #3A3A3A;
            border-radius: 12px;
            padding: 16px;
        }

        .comment-input {
            width: 100%;
            background: #444;
            border: none;
            border-radius: 12px;
            padding: 12px 16px;
            color: white;
            font-size: 14px;
            margin-bottom: 12px;
            resize: none;
            min-height: 80px;
        }

        .comment-submit {
            background: #FF6B81;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
        }

        /* Панель поиска */
        .search-panel {
            position: fixed;
            top: -100%;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 400px;
            background: #3A3A3A;
            border-radius: 16px;
            padding: 20px;
            z-index: 1000;
            transition: all 0.3s ease;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
        }

        .search-panel.active {
            top: 80px;
        }

        .search-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }

        .search-input {
            flex: 1;
            padding: 12px 16px;
            background: #444;
            border: none;
            border-radius: 30px;
            color: white;
            font-size: 16px;
        }

        .filter-icon {
            margin-left: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #444;
        }

        .filter-icon.active {
            background: #FF6B81;
        }

        .filters {
            margin-top: 20px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .filters.active {
            max-height: 500px;
        }

        .filter-group {
            margin-bottom: 16px;
        }

        .filter-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .filter-options {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .filter-option {
            background: #444;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
        }

        .filter-option.active {
            background: #FF6B81;
        }

        /* Оверлей */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 999;
            display: none;
        }

        .overlay.active {
            display: block;
        }

        /* Пустое состояние */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #BBBBBB;
        }

        .empty-icon {
            font-size: 60px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-text {
            font-size: 18px;
            margin-bottom: 10px;
        }

        .empty-subtext {
            font-size: 14px;
        }

        /* Страница профиля */
        .profile-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .profile-header {
            display: flex;
            align-items: center;
            margin-bottom: 24px;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 20px;
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 4px;
        }

        .profile-username {
            color: #BBBBBB;
            margin-bottom: 8px;
        }

        .profile-stats {
            display: flex;
            gap: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
        }

        .stat-label {
            font-size: 14px;
            color: #BBBBBB;
        }

        .profile-section {
            background: #3A3A3A;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 16px;
        }

        /* Страница закладок */
        .bookmarks-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .bookmarks-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .bookmark-filter {
            background: #444;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            white-space: nowrap;
        }

        .bookmark-filter.active {
            background: #FF6B81;
        }

        /* Страница выбора темы */
        .theme-options {
            max-width: 400px;
            margin: 0 auto;
        }

        .theme-option {
            display: flex;
            align-items: center;
            padding: 16px;
            background: #3A3A3A;
            border-radius: 12px;
            margin-bottom: 12px;
            cursor: pointer;
        }

        .theme-option.active {
            background: #FF6B81;
        }

        .theme-preview {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            margin-right: 12px;
            border: 2px solid transparent;
        }

        .theme-preview.classic {
            background: #2D2D2D;
            border-color: #FF6B81;
        }

        .theme-preview.light {
            background: #f5f5f5;
            border-color: #ddd;
        }

        .theme-preview.dark {
            background: #121212;
            border-color: #333;
        }

        .theme-name {
            font-size: 16px;
            font-weight: bold;
        }

        /* Админ-панель */
        .admin-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .admin-login-form {
            background: #3A3A3A;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: #BBBBBB;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            background: #444;
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
        }

        .form-select {
            width: 100%;
            padding: 12px 16px;
            background: #444;
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
        }

        .admin-btn {
            background: #FF6B81;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
        }

        .admin-menu {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 20px;
        }

        .admin-menu-item {
            background: #3A3A3A;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
        }

        .admin-menu-item:hover {
            background: #444;
        }

        .admin-form {
            background: #3A3A3A;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .form-row {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        .episode-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .remove-btn {
            background: #ff4757;
        }

        /* Календарь релизов */
        .calendar {
            margin-top: 20px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .calendar-title {
            font-size: 18px;
            font-weight: bold;
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
        }

        .calendar-nav-btn {
            background: #444;
            border: none;
            border-radius: 20px;
            padding: 8px 16px;
            color: white;
            cursor: pointer;
        }

        .calendar-days {
            display: flex;
            overflow-x: auto;
            gap: 8px;
            padding-bottom: 10px;
        }

        .calendar-day {
            min-width: 80px;
            padding: 12px;
            background: #3A3A3A;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
        }

        .calendar-day.active {
            background: #FF6B81;
        }

        .calendar-day-name {
            font-size: 14px;
            margin-bottom: 4px;
        }

        .calendar-day-date {
            font-size: 16px;
            font-weight: bold;
        }

        .calendar-releases {
            margin-top: 20px;
        }

        /* Блокировка комментариев */
        .banned-users {
            margin-top: 20px;
        }

        .banned-user {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #3A3A3A;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .banned-username {
            font-weight: bold;
        }

        .unban-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
        }

        /* Управление комментариями */
        .comment-manage {
            margin-top: 20px;
        }

        .comment-item {
            background: #3A3A3A;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .comment-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .comment-user-info {
            display: flex;
            align-items: center;
        }

        .comment-actions-admin {
            display: flex;
            gap: 8px;
        }

        .delete-comment-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <img id="user-avatar" class="avatar" src="" alt="Аватар">
        <svg class="search-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z" fill="white"/>
        </svg>
    </header>

    <!-- Центральное меню -->
    <div class="center-menu" id="center-menu">
        <div class="user-info">
            <img id="menu-avatar" src="" alt="Аватар">
            <div>
                <div id="menu-username"></div>
                <small>Telegram</small>
            </div>
        </div>
        <ul class="menu-items">
            <li data-page="profile">Профиль</li>
            <li data-page="bookmarks">Закладки</li>
            <li data-page="theme">Тема</li>
            <li id="admin-menu" data-page="admin-login">Админ-панель</li>
        </ul>
    </div>

    <!-- Панель поиска -->
    <div class="search-panel" id="search-panel">
        <div class="search-header">
            <input type="text" class="search-input" placeholder="Поиск аниме...">
            <div class="filter-icon" id="filter-toggle">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M4.25 5.61C6.27 8.2 10 13 10 13V19C10 19.55 10.45 20 11 20H13C13.55 20 14 19.55 14 19V13C14 13 17.72 8.2 19.74 5.61C20.25 4.95 19.78 4 18.95 4H5.04C4.21 4 3.74 4.95 4.25 5.61Z" fill="white"/>
                </svg>
            </div>
        </div>
        <div class="filters" id="filters">
            <div class="filter-group">
                <div class="filter-title">Жанры</div>
                <div class="filter-options">
                    <div class="filter-option">Экшен</div>
                    <div class="filter-option">Фэнтези</div>
                    <div class="filter-option">Комедия</div>
                    <div class="filter-option">Драма</div>
                    <div class="filter-option">Романтика</div>
                </div>
            </div>
            <div class="filter-group">
                <div class="filter-title">Статус</div>
                <div class="filter-options">
                    <div class="filter-option">Ожидается</div>
                    <div class="filter-option">Выходит</div>
                    <div class="filter-option">Завершен</div>
                </div>
            </div>
            <div class="filter-group">
                <div class="filter-title">Год выпуска</div>
                <div class="filter-options">
                    <div class="filter-option">2024</div>
                    <div class="filter-option">2023</div>
                    <div class="filter-option">2022</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Главный контент -->
    <div class="main-content">
        <!-- Горизонтальный скролл -->
        <div class="hero">
            <div class="horizontal-scroll" id="featured-scroll">
                <!-- Контент будет заполняться динамически из JavaScript -->
            </div>
            <div class="dots-container" id="dots-container">
                <!-- Точки будут добавлены динамически -->
            </div>
        </div>
        
        <!-- Вертикальный список -->
        <div class="vertical-list" id="anime-list">
            <!-- Контент будет заполняться динамически из JavaScript -->
        </div>
        
        <!-- Пример пустого состояния -->
        <div class="empty-state" id="empty-state" style="display: none;">
            <div class="empty-icon">📺</div>
            <div class="empty-text">Здесь пока ничего нет</div>
            <div class="empty-subtext">Попробуйте посмотреть в другом разделе</div>
        </div>
    </div>

    <!-- Страница деталей -->
    <div class="detail-page" id="detail-page">
        <div class="detail-header">
            <div class="detail-bg" id="detail-bg"></div>
            <img src="" class="detail-cover" id="detail-cover" alt="Обложка">
            <div class="detail-actions">
                <div class="back-btn">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15.41 16.59L10.83 12L15.41 7.41L14 6L8 12L14 18L15.41 16.59Z" fill="white"/>
                    </svg>
                </div>
            </div>
            <div class="bookmark-btn" id="bookmark-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17 3H7C5.9 3 5 3.9 5 5V21L12 18L19 21V5C19 3.9 18.1 3 17 3Z" fill="white" stroke="white" stroke-width="2"/>
                </svg>
            </div>
            <div class="bookmark-menu" id="bookmark-menu">
                <div class="bookmark-option" data-status="watched">Просмотрено</div>
                <div class="bookmark-option" data-status="planned">Планирую</div>
                <div class="bookmark-option" data-status="dropped">Брошено</div>
                <div class="bookmark-option" data-status="favorite">Любимое</div>
                <div class="bookmark-option" data-status="bookmarked">Избранное</div>
            </div>
        </div>
        
        <div class="detail-body">
            <h1 class="detail-title" id="detail-title"></h1>
            <div class="detail-subtitle">
                <div class="detail-year" id="detail-year"></div>
                <div class="detail-eng-title" id="detail-eng-title"></div>
            </div>
            
            <div class="tabs-container">
                <div class="tabs">
                    <div class="tab active" data-tab="general">Общее</div>
                    <div class="tab" data-tab="episodes">Серии</div>
                    <div class="tab" data-tab="rating">Рейтинг</div>
                    <div class="tab" data-tab="comments">Комментарии</div>
                </div>
            </div>
            
            <div class="tab-content active" id="general-content">
                <div class="info-item">
                    <div class="info-label">Серий</div>
                    <div class="info-value" id="episodes-count"></div>
                </div>
                <div class="info-item">
                    <div class="info-label">Жанры</div>
                    <div class="info-value" id="detail-genres"></div>
                </div>
                <div class="info-item">
                    <div class="info-label">Сезон</div>
                    <div class="info-value" id="detail-season"></div>
                </div>
                <div class="info-item">
                    <div class="info-label">Озвучивали</div>
                    <div class="info-value" id="detail-voices"></div>
                </div>
                <div class="info-item">
                    <div class="info-label">Тайминг</div>
                    <div class="info-value" id="detail-timing"></div>
                </div>
                <div class="info-item">
                    <div class="info-label">Состояние</div>
                    <div class="info-value" id="detail-status"></div>
                </div>
                <div class="info-item">
                    <div class="info-label">Описание</div>
                    <div class="info-value" id="detail-description"></div>
                </div>
                <button class="watch-btn-large" id="watch-btn">Смотреть</button>
            </div>
            
            <div class="tab-content" id="episodes-content">
                <div class="episodes-list" id="episodes-list">
                    <!-- Список серий будет заполняться динамически -->
                </div>
            </div>
            
            <div class="tab-content" id="rating-content">
                <div class="rating-container">
                    <div class="rating-value" id="rating-value"></div>
                    <div class="rating-count" id="rating-count"></div>
                    <div class="stars-container">
                        <div class="star" data-rating="1">★</div>
                        <div class="star" data-rating="2">★</div>
                        <div class="star" data-rating="3">★</div>
                        <div class="star" data-rating="4">★</div>
                        <div class="star" data-rating="5">★</div>
                    </div>
                    
                    <div class="rating-chart" id="rating-chart">
                        <!-- График рейтинга будет заполняться динамически -->
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="comments-content">
                <div class="comments-container" id="comments-container">
                    <!-- Комментарии будут заполняться динамически -->
                    <div class="comment-form">
                        <textarea class="comment-input" id="comment-input" placeholder="Напишите ваш комментарий..."></textarea>
                        <button class="comment-submit" id="comment-submit">Отправить</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Страница профиля -->
    <div class="page" id="profile-page">
        <div class="page-header">
            <div class="back-icon" data-back="main">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.41 16.59L10.83 12L15.41 7.41L14 6L8 12L14 18L15.41 16.59Z" fill="white"/>
                </svg>
            </div>
            <h2 class="page-title">Профиль</h2>
        </div>
        
        <div class="profile-container">
            <div class="profile-header">
                <img src="" class="profile-avatar" id="profile-avatar" alt="Аватар">
                <div class="profile-info">
                    <div class="profile-name" id="profile-name"></div>
                    <div class="profile-username" id="profile-username"></div>
                    <div class="profile-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="watched-count">0</div>
                            <div class="stat-label">Просмотрено</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="planned-count">0</div>
                            <div class="stat-label">В планах</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="comments-count">0</div>
                            <div class="stat-label">Комментарии</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="profile-section">
                <h3 class="section-title">Последняя активность</h3>
                <div id="last-activity">
                    <!-- Активность будет заполняться динамически -->
                </div>
            </div>
            
            <div class="profile-section">
                <h3 class="section-title">Избранные жанры</h3>
                <div class="anime-genre" id="favorite-genres">
                    <!-- Жанры будут заполняться динамически -->
                </div>
            </div>
        </div>
    </div>

    <!-- Страница закладок -->
    <div class="page" id="bookmarks-page">
        <div class="page-header">
            <div class="back-icon" data-back="main">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.41 16.59L10.83 12L15.41 7.41L14 6L8 12L14 18L15.41 16.59Z" fill="white"/>
                </svg>
            </div>
            <h2 class="page-title">Закладки</h2>
        </div>
        
        <div class="bookmarks-container">
            <div class="bookmarks-filters" id="bookmarks-filters">
                <div class="bookmark-filter active" data-status="all">Все</div>
                <div class="bookmark-filter" data-status="watched">Просмотрено</div>
                <div class="bookmark-filter" data-status="planned">В планах</div>
                <div class="bookmark-filter" data-status="dropped">Брошено</div>
                <div class="bookmark-filter" data-status="favorite">Любимые</div>
            </div>
            
            <div class="vertical-list" id="bookmarks-list">
                <!-- Закладки будут заполняться динамически -->
            </div>
        </div>
    </div>

    <!-- Страница выбора темы -->
    <div class="page" id="theme-page">
        <div class="page-header">
            <div class="back-icon" data-back="main">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.41 16.59L10.83 12L15.41 7.41L14 6L8 12L14 18L15.41 16.59Z" fill="white"/>
                </svg>
            </div>
            <h2 class="page-title">Выбор темы</h2>
        </div>
        
        <div class="theme-options">
            <div class="theme-option active" data-theme="classic">
                <div class="theme-preview classic"></div>
                <div class="theme-name">Классика</div>
            </div>
            <div class="theme-option" data-theme="light">
                <div class="theme-preview light"></div>
                <div class="theme-name">Светлая</div>
            </div>
            <div class="theme-option" data-theme="dark">
                <div class="theme-preview dark"></div>
                <div class="theme-name">Тёмная</div>
            </div>
        </div>
    </div>

    <!-- Админ-панель: Вход -->
    <div class="page" id="admin-login-page">
        <div class="page-header">
            <div class="back-icon" data-back="main">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.41 16.59L10.83 12L15.41 7.41L14 6L8 12L14 18L15.41 16.59Z" fill="white"/>
                </svg>
            </div>
            <h2 class="page-title">Админ-панель</h2>
        </div>
        
        <div class="admin-container">
            <p>Для доступа к админ-панели требуется авторизация</p>
            
            <div class="admin-login-form">
                <div class="form-group">
                    <label class="form-label">Логин</label>
                    <input type="text" class="form-input" id="admin-login" placeholder="Введите логин">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Пароль</label>
                    <input type="password" class="form-input" id="admin-password" placeholder="Введите пароль">
                </div>
                
                <button class="admin-btn" id="admin-login-btn">Войти</button>
            </div>
        </div>
    </div>

    <!-- Админ-панель: Главная -->
    <div class="page" id="admin-main-page">
        <div class="page-header">
            <div class="back-icon" data-back="admin-login">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.41 16.59L10.83 12L15.41 7.41L14 6L8 12L14 18L15.41 16.59Z" fill="white"/>
                </svg>
            </div>
            <h2 class="page-title">Админ-панель</h2>
        </div>
        
        <div class="admin-container">
            <div class="admin-menu">
                <div class="admin-menu-item" data-page="admin-releases">
                    Календарь релизов
                </div>
                <div class="admin-menu-item" data-page="admin-edit">
                    Редактировать тайтл
                </div>
                <div class="admin-menu-item" data-page="admin-comments">
                    Управление комментариями
                </div>
                <div class="admin-menu-item" data-page="admin-stats">
                    Статистика
                </div>
            </div>
        </div>
    </div>

    <!-- Админ-панель: Календарь релизов -->
    <div class="page" id="admin-releases-page">
        <div class="page-header">
            <div class="back-icon" data-back="admin-main">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.41 16.59L10.83 12L15.41 7.41L14 6L8 12L14 18L15.41 16.59Z" fill="white"/>
                </svg>
            </div>
            <h2 class="page-title">Календарь релизов</h2>
        </div>
        
        <div class="admin-container">
            <div class="calendar">
                <div class="calendar-header">
                    <div class="calendar-title">Релизы на неделю</div>
                    <div class="calendar-nav">
                        <button class="calendar-nav-btn" id="prev-week">←</button>
                        <button class="calendar-nav-btn" id="next-week">→</button>
                    </div>
                </div>
                
                <div class="calendar-days" id="calendar-days">
                    <!-- Дни недели будут заполняться динамически -->
                </div>
                
                <div class="calendar-releases" id="calendar-releases">
                    <!-- Релизы будут заполняться динамически -->
                </div>
            </div>
            
            <button class="admin-btn" id="add-release-btn" style="margin-top: 20px;">Добавить релиз</button>
        </div>
    </div>

    <!-- Админ-панель: Редактирование тайтла -->
    <div class="page" id="admin-edit-page">
        <div class="page-header">
            <div class="back-icon" data-back="admin-main">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.41 16.59L10.83 12L15.41 7.41L14 6L8 12L14 18L15.41 16.59Z" fill="white"/>
                </svg>
            </div>
            <h2 class="page-title">Редактирование тайтла</h2>
        </div>
        
        <div class="admin-container">
            <div class="admin-form">
                <div class="form-group">
                    <label class="form-label">Выберите тайтл</label>
                    <select class="form-select" id="anime-select">
                        <!-- Опции будут заполняться динамически -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Название</label>
                    <input type="text" class="form-input" id="anime-title">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Английское название</label>
                    <input type="text" class="form-input" id="anime-eng-title">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Год выпуска</label>
                        <input type="text" class="form-input" id="anime-year">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Статус</label>
                        <select class="form-select" id="anime-status">
                            <option value="planned">Ожидается</option>
                            <option value="ongoing">Выходит</option>
                            <option value="completed">Завершен</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Описание</label>
                    <textarea class="form-input" rows="4" id="anime-description"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Жанры (через запятую)</label>
                    <input type="text" class="form-input" id="anime-genres" placeholder="Экшен, Фэнтези, Приключения">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Сезон</label>
                    <input type="text" class="form-input" id="anime-season" placeholder="Зима 2024">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Озвучивали (никнейм:ссылка, через запятую)</label>
                    <textarea class="form-input" rows="2" id="anime-voices" placeholder="Familiar:https://t.me/familiar, Kito:https://t.me/kito"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Тайминг</label>
                    <input type="text" class="form-input" id="anime-timing" placeholder="GWUNBLAIDE">
                </div>
                
                <div class="form-group">
                    <label class="form-label">URL картинки (главная)</label>
                    <input type="text" class="form-input" id="anime-image">
                </div>
                
                <div class="form-group">
                    <label class="form-label">URL картинки (миниатюра)</label>
                    <input type="text" class="form-input" id="anime-thumbnail">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Общее количество серий</label>
                    <input type="number" class="form-input" id="anime-total-episodes">
                </div>
                
                <h3 class="section-title" style="margin: 20px 0 10px;">Серии</h3>
                
                <div id="episodes-container">
                    <!-- Серии будут заполняться динамически -->
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Номер серии</label>
                        <input type="number" class="form-input" id="new-episode-number">
                    </div>
                    <div class="form-group">
                        <label class="form-label">URL для встраивания</label>
                        <input type="text" class="form-input" id="new-episode-url" placeholder="https://example.com/episode1">
                    </div>
                </div>
                
                <button class="admin-btn" id="add-episode-btn" style="background: #2ed573;">Добавить серию</button>
                <button class="admin-btn" id="save-anime-btn">Сохранить изменения</button>
                <button class="admin-btn remove-btn" id="delete-anime-btn">Удалить тайтл</button>
            </div>
        </div>
    </div>

    <!-- Админ-панель: Управление комментариями -->
    <div class="page" id="admin-comments-page">
        <div class="page-header">
            <div class="back-icon" data-back="admin-main">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.41 16.59L10.83 12L15.41 7.41L14 6L8 12L14 18L15.41 16.59Z" fill="white"/>
                </svg>
            </div>
            <h2 class="page-title">Управление комментариями</h2>
        </div>
        
        <div class="admin-container">
            <div class="admin-form">
                <div class="form-group">
                    <label class="form-label">Заблокированные пользователи</label>
                    <div class="banned-users" id="banned-users">
                        <!-- Список заблокированных пользователей -->
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Юзернейм для блокировки</label>
                        <input type="text" class="form-input" id="ban-username" placeholder="Введите @username">
                    </div>
                    <button class="admin-btn" id="ban-user-btn" style="margin-top: 24px;">Заблокировать</button>
                </div>
            </div>
            
            <div class="comment-manage" id="comment-manage">
                <h3 class="section-title">Последние комментарии</h3>
                <!-- Комментарии для управления -->
            </div>
        </div>
    </div>

    <!-- Оверлей -->
    <div class="overlay" id="overlay"></div>

    <script>
        // Инициализация Telegram Web App
        const tg = window.Telegram.WebApp;
        tg.expand();
        
        // Элементы DOM
        const elements = {
            avatar: document.getElementById('user-avatar'),
            menuAvatar: document.getElementById('menu-avatar'),
            menuUsername: document.getElementById('menu-username'),
            centerMenu: document.getElementById('center-menu'),
            detailPage: document.getElementById('detail-page'),
            overlay: document.getElementById('overlay'),
            searchPanel: document.getElementById('search-panel'),
            searchIcon: document.querySelector('.search-icon'),
            filters: document.getElementById('filters'),
            filterToggle: document.getElementById('filter-toggle'),
            bookmarkBtn: document.getElementById('bookmark-btn'),
            bookmarkMenu: document.getElementById('bookmark-menu'),
            featuredScroll: document.getElementById('featured-scroll'),
            dotsContainer: document.getElementById('dots-container'),
            animeList: document.getElementById('anime-list'),
            emptyState: document.getElementById('empty-state'),
            pages: {
                main: document.querySelector('.main-content'),
                profile: document.getElementById('profile-page'),
                bookmarks: document.getElementById('bookmarks-page'),
                theme: document.getElementById('theme-page'),
                adminLogin: document.getElementById('admin-login-page'),
                adminMain: document.getElementById('admin-main-page'),
                adminReleases: document.getElementById('admin-releases-page'),
                adminEdit: document.getElementById('admin-edit-page'),
                adminComments: document.getElementById('admin-comments-page')
            }
        };

        // Данные пользователя из Telegram
        const user = tg.initDataUnsafe.user || {
            photo_url: 'https://via.placeholder.com/150',
            first_name: 'Аноним',
            username: 'telegram_user'
        };
        
        // Данные приложения (заглушка, в реальном приложении будет запрос к API)
        let appData = {
            animeList: [],
            bookmarks: [],
            comments: [],
            bannedUsers: [],
            calendar: [],
            currentAnime: null,
            currentDay: null
        };

        // Инициализация данных
        function initData() {
            // Заглушка с данными аниме
            appData.animeList = [
                {
                    id: 1,
                    title: "Поднятие уровня в одиночку",
                    engTitle: "Solo Leveling",
                    year: "2024",
                    description: "Десять лет назад распахнулись Врата нашего мира с миром монстров. После этого некоторым смертным был дан дар уничтожать монстров внутри Врат. Таких смертных назвали охотниками. Однако не все охотники достаточно сильны. Джин-Ву – охотник уровня Е. Парню приходится рисковать жизнью в темных подземельях, выполняя самые неперспективные задания. Дело в том, что охотник не имеет необходимых качеств для повышения, поэтому он вынужден выполнять черновую работу. Джин-Ву снова и снова спускался в подземелья, сражаясь с нижайшими монстрами, пока однажды не забреддет в подземелье уровня D. Пребывание в сложнейшем подземелье даровало парню удивительную",
                    genres: ["Экшен", "Фэнтези", "Приключения"],
                    season: "Зима 2024",
                    voices: [
                        {name: "Familiar", link: "https://t.me/familiar"},
                        {name: "Kito", link: "https://t.me/kito"},
                        {name: "Hiyorikio", link: "https://t.me/hiyorikio"}
                    ],
                    timing: "GWUNBLAIDE",
                    status: "ongoing",
                    image: "https://i.imgur.com/OY7QK5o.jpeg",
                    thumbnail: "https://i.imgur.com/OY7QK5o.jpeg",
                    totalEpisodes: 12,
                    episodes: [
                        {number: 1, url: "https://example.com/episode1"},
                        {number: 2, url: "https://example.com/episode2"}
                    ],
                    rating: 4.8,
                    ratingCount: 1245,
                    ratingDistribution: [65, 20, 8, 4, 3],
                    releaseDay: "Понедельник"
                },
                {
                    id: 2,
                    title: "Дни Сакомото",
                    engTitle: "Sakamoto desu ga?",
                    year: "2016",
                    description: "Дни Сакомото (Sakamoto desu ga?) – это комедийное аниме, рассказывающее о жизни старшеклассника по имени Сакомото, который, кажется, обладает безупречным стилем и невозмутимостью в любой ситуации.",
                    genres: ["Комедия", "Школа"],
                    season: "Весна 2016",
                    voices: [
                        {name: "Diaiver", link: "https://t.me/diaiver"},
                        {name: "Eezy", link: "https://t.me/eezy"}
                    ],
                    timing: "Lord of Emotions",
                    status: "completed",
                    image: "https://via.placeholder.com/1000x500/FF6B81/FFFFFF?text=Дни+Сакомото",
                    thumbnail: "https://via.placeholder.com/120x170/FF6B81/FFFFFF?text=Сакомото",
                    totalEpisodes: 12,
                    episodes: [
                        {number: 1, url: "https://example.com/sakamoto1"},
                        {number: 2, url: "https://example.com/sakamoto2"}
                    ],
                    rating: 4.5,
                    ratingCount: 890,
                    ratingDistribution: [50, 30, 10, 5, 5],
                    releaseDay: "Среда"
                },
                {
                    id: 3,
                    title: "Моя геройская академия",
                    engTitle: "My Hero Academia",
                    year: "2016",
                    description: "В мире, где суперспособности стали обычным явлением, мальчик без способностей мечтает стать героем. Он попадает в академию для героев, где учится использовать свой ум и находчивость, чтобы конкурировать с теми, кто родился с особенными способностями.",
                    genres: ["Экшен", "Супергерои", "Школа"],
                    season: "Весна 2016",
                    voices: [
                        {name: "Vatavu", link: "https://t.me/vatavu"},
                        {name: "FSLB", link: "https://t.me/fslb"}
                    ],
                    timing: "ShiYori",
                    status: "ongoing",
                    image: "https://via.placeholder.com/1000x500/FF6B81/FFFFFF?text=Геройская+академия",
                    thumbnail: "https://via.placeholder.com/120x170/FF6B81/FFFFFF?text=Геройская",
                    totalEpisodes: 24,
                    episodes: [
                        {number: 1, url: "https://example.com/mha1"},
                        {number: 2, url: "https://example.com/mha2"}
                    ],
                    rating: 4.9,
                    ratingCount: 2100,
                    ratingDistribution: [70, 20, 5, 3, 2],
                    releaseDay: "Суббота"
                }
            ];
            
            // Заглушка с закладками пользователя
            appData.bookmarks = [
                {animeId: 1, status: "planned", lastWatchedEpisode: 0},
                {animeId: 2, status: "watched", lastWatchedEpisode: 12}
            ];
            
            // Заглушка с комментариями
            appData.comments = [
                {
                    id: 1,
                    animeId: 1,
                    userId: user.id,
                    username: user.username,
                    avatar: user.photo_url,
                    text: "Отличное аниме! Графика на высоте, сюжет захватывающий, персонажи проработаны.",
                    date: "2 часа назад",
                    likes: 5,
                    dislikes: 0
                }
            ];
            
            // Заглушка с заблокированными пользователями
            appData.bannedUsers = ["spammer", "troll"];
            
            // Инициализация календаря
            initCalendar();
        }
        
        // Инициализация календаря релизов
        function initCalendar() {
            const daysOfWeek = ["Понедельник", "Вторник", "Среда", "Четверг", "Пятница", "Суббота", "Воскресенье"];
            const today = new Date();
            const currentDay = today.getDay() - 1; // 0-6 (Пн-Вс)
            
            appData.calendar = daysOfWeek.map(day => {
                return {
                    dayName: day,
                    date: getNextDayDate(day, today),
                    releases: appData.animeList.filter(anime => anime.releaseDay === day)
                };
            });
            
            appData.currentDay = currentDay >= 0 ? currentDay : 6; // Если воскресенье (0 в JS), то 6 в нашем массиве
        }
        
        // Получение даты следующего указанного дня недели
        function getNextDayDate(dayName, fromDate) {
            const days = ["Понедельник", "Вторник", "Среда", "Четверг", "Пятница", "Суббота", "Воскресенье"];
            const dayIndex = days.indexOf(dayName);
            const resultDate = new Date(fromDate);
            
            resultDate.setDate(fromDate.getDate() + (dayIndex - fromDate.getDay() + 7) % 7);
            return resultDate;
        }
        
        // Установка данных пользователя
        function setupUserData() {
            elements.avatar.src = user.photo_url;
            elements.menuAvatar.src = user.photo_url;
            elements.menuUsername.textContent = `@${user.username}`;
            
            // Заполнение профиля
            document.getElementById('profile-avatar').src = user.photo_url;
            document.getElementById('profile-name').textContent = user.first_name;
            document.getElementById('profile-username').textContent = `@${user.username}`;
            
            // Обновление счетчиков профиля
            updateProfileCounters();
            
            // Заполнение последней активности
            updateLastActivity();
            
            // Заполнение избранных жанров
            updateFavoriteGenres();
        }
        
        // Обновление счетчиков профиля
        function updateProfileCounters() {
            const watchedCount = appData.bookmarks.filter(b => b.status === 'watched').length;
            const plannedCount = appData.bookmarks.filter(b => b.status === 'planned').length;
            const commentsCount = appData.comments.filter(c => c.userId === user.id).length;
            
            document.getElementById('watched-count').textContent = watchedCount;
            document.getElementById('planned-count').textContent = plannedCount;
            document.getElementById('comments-count').textContent = commentsCount;
        }
        
        // Обновление последней активности
        function updateLastActivity() {
            const lastActivity = document.getElementById('last-activity');
            lastActivity.innerHTML = '';
            
            const userComments = appData.comments
                .filter(c => c.userId === user.id)
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 3);
            
            if (userComments.length === 0) {
                lastActivity.innerHTML = '<p>Активность не найдена</p>';
                return;
            }
            
            userComments.forEach(comment => {
                const anime = appData.animeList.find(a => a.id === comment.animeId);
                if (!anime) return;
                
                const commentEl = document.createElement('div');
                commentEl.className = 'comment';
                commentEl.innerHTML = `
                    <div class="comment-header">
                        <img src="${comment.avatar}" class="comment-avatar" alt="Аватар">
                        <div>
                            <div class="comment-user">Вы</div>
                            <div class="comment-date">${comment.date}</div>
                        </div>
                    </div>
                    <div class="comment-text">
                        <strong>${anime.title}</strong><br>
                        ${comment.text}
                    </div>
                    <div class="comment-actions">
                        <div class="comment-action">👍 ${comment.likes}</div>
                        <div class="comment-action">👎 ${comment.dislikes}</div>
                    </div>
                `;
                
                lastActivity.appendChild(commentEl);
            });
        }
        
        // Обновление избранных жанров
        function updateFavoriteGenres() {
            const favoriteGenres = document.getElementById('favorite-genres');
            favoriteGenres.innerHTML = '';
            
            // Получаем все жанры из закладок пользователя
            const userAnimeIds = appData.bookmarks.map(b => b.animeId);
            const userAnime = appData.animeList.filter(a => userAnimeIds.includes(a.id));
            
            const allGenres = userAnime.flatMap(a => a.genres);
            const genreCounts = {};
            
            allGenres.forEach(genre => {
                genreCounts[genre] = (genreCounts[genre] || 0) + 1;
            });
            
            // Сортируем по популярности и берем топ-4
            const topGenres = Object.entries(genreCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 4)
                .map(g => g[0]);
            
            topGenres.forEach(genre => {
                const tag = document.createElement('span');
                tag.className = 'genre-tag';
                tag.textContent = genre;
                favoriteGenres.appendChild(tag);
            });
            
            if (topGenres.length === 0) {
                favoriteGenres.innerHTML = '<p>Избранные жанры не найдены</p>';
            }
        }
        
        // Отображение списка аниме
        function renderAnimeList() {
            const animeList = document.getElementById('anime-list');
            animeList.innerHTML = '';
            
            if (appData.animeList.length === 0) {
                elements.emptyState.style.display = 'block';
                return;
            }
            
            elements.emptyState.style.display = 'none';
            
            appData.animeList.forEach(anime => {
                const bookmark = appData.bookmarks.find(b => b.animeId === anime.id);
                const status = bookmark ? bookmark.status : null;
                
                const card = document.createElement('div');
                card.className = 'anime-card';
                card.dataset.id = anime.id;
                
                card.innerHTML = `
                    <img src="${anime.thumbnail}" class="anime-poster" alt="${anime.title}">
                    <div class="anime-content">
                        <h3 class="anime-title">${anime.title}</h3>
                        <div class="anime-genre">
                            ${anime.genres.map(genre => `<span class="genre-tag">${genre}</span>`).join('')}
                        </div>
                        <div class="anime-description">
                            ${anime.description.substring(0, 100)}...
                        </div>
                        ${status ? `<div class="anime-description"><span class="featured-rating">${getStatusText(status)}</span></div>` : ''}
                        <button class="watch-btn">Смотреть</button>
                    </div>
                `;
                
                animeList.appendChild(card);
            });
            
            // Добавляем обработчики событий для карточек
            document.querySelectorAll('.anime-card').forEach(card => {
                card.addEventListener('click', (e) => {
                    if (e.target.classList.contains('watch-btn')) {
                        const animeId = parseInt(card.dataset.id);
                        showAnimeDetails(animeId);
                        showEpisodesTab();
                    } else {
                        const animeId = parseInt(card.dataset.id);
                        showAnimeDetails(animeId);
                    }
                });
            });
        }
        
        // Отображение featured-аниме (календарь на сегодня)
        function renderFeaturedAnime() {
            const featuredScroll = document.getElementById('featured-scroll');
            const dotsContainer = document.getElementById('dots-container');
            
            featuredScroll.innerHTML = '';
            dotsContainer.innerHTML = '';
            
            const todayReleases = appData.calendar[appData.currentDay].releases;
            
            if (todayReleases.length === 0) {
                featuredScroll.innerHTML = '<div class="empty-text">Сегодня нет релизов</div>';
                return;
            }
            
            todayReleases.forEach((anime, index) => {
                const card = document.createElement('div');
                card.className = 'featured-card';
                
                card.innerHTML = `
                    <img src="${anime.image}" alt="${anime.title}">
                    <div class="status-badge">${getStatusText(anime.status)}</div>
                    <div class="featured-info">
                        <div class="featured-title">${anime.title}</div>
                        <div class="featured-rating">★ ${anime.rating}</div>
                    </div>
                `;
                
                featuredScroll.appendChild(card);
                
                // Добавляем точку
                const dot = document.createElement('div');
                dot.className = 'dot' + (index === 0 ? ' active' : '');
                dot.addEventListener('click', () => scrollToCard(index));
                dotsContainer.appendChild(dot);
            });
            
            // Добавляем обработчики событий для карточек
            document.querySelectorAll('.featured-card').forEach(card => {
                card.addEventListener('click', () => {
                    const animeTitle = card.querySelector('.featured-title').textContent;
                    const anime = appData.animeList.find(a => a.title === animeTitle);
                    if (anime) showAnimeDetails(anime.id);
                });
            });
        }
        
        // Получение текста статуса
        function getStatusText(status) {
            switch (status) {
                case 'planned': return 'Ожидается';
                case 'ongoing': return 'Выходит';
                case 'completed': return 'Завершен';
                case 'watched': return 'Просмотрено';
                case 'dropped': return 'Брошено';
                case 'favorite': return 'Любимое';
                default: return status;
            }
        }
        
        // Отображение деталей аниме
        function showAnimeDetails(animeId) {
            const anime = appData.animeList.find(a => a.id === animeId);
            if (!anime) return;
            
            appData.currentAnime = anime;
            
            // Установка изображения
            document.getElementById('detail-bg').style.backgroundImage = `url(${anime.image})`;
            document.getElementById('detail-cover').src = anime.thumbnail;
            
            // Установка текстовых данных
            document.getElementById('detail-title').textContent = anime.title;
            document.getElementById('detail-year').textContent = anime.year;
            document.getElementById('detail-eng-title').textContent = anime.engTitle;
            document.getElementById('episodes-count').textContent = `${anime.episodes.length} из ${anime.totalEpisodes}`;
            document.getElementById('detail-genres').innerHTML = anime.genres.map(g => `<span class="tag">${g}</span>`).join('');
            document.getElementById('detail-season').textContent = anime.season;
            document.getElementById('detail-voices').innerHTML = anime.voices.map(v => 
                `<a href="${v.link}" class="voice-tag" target="_blank">${v.name}</a>`
            ).join('');
            document.getElementById('detail-timing').textContent = anime.timing;
            document.getElementById('detail-status').textContent = getStatusText(anime.status);
            document.getElementById('detail-description').textContent = anime.description;
            
            // Установка рейтинга
            document.getElementById('rating-value').textContent = anime.rating;
            document.getElementById('rating-count').textContent = `На основе ${anime.ratingCount} оценок`;
            
            // Отрисовка графика рейтинга
            renderRatingChart(anime.ratingDistribution);
            
            // Проверка закладки
            const bookmark = appData.bookmarks.find(b => b.animeId === anime.id);
            const bookmarkBtn = document.getElementById('bookmark-btn');
            if (bookmark) {
                bookmarkBtn.querySelector('path').setAttribute('fill', '#FF6B81');
            } else {
                bookmarkBtn.querySelector('path').setAttribute('fill', 'white');
            }
            
            // Показываем страницу деталей
            elements.detailPage.classList.add('active');
        }
        
        // Отображение графика рейтинга
        function renderRatingChart(distribution) {
            const chartContainer = document.getElementById('rating-chart');
            chartContainer.innerHTML = '';
            
            for (let i = 5; i >= 1; i--) {
                const row = document.createElement('div');
                row.className = 'chart-row';
                
                row.innerHTML = `
                    <div class="chart-label">${i}★</div>
                    <div class="chart-bar-container">
                        <div class="chart-bar" style="width: ${distribution[5-i]}%"></div>
                    </div>
                    <div class="chart-value">${distribution[5-i]}%</div>
                `;
                
                chartContainer.appendChild(row);
            }
        }
        
        // Показать вкладку с сериями
        function showEpisodesTab() {
            const anime = appData.currentAnime;
            if (!anime) return;
            
            const episodesList = document.getElementById('episodes-list');
            episodesList.innerHTML = '';
            
            anime.episodes.forEach(ep => {
                const episodeItem = document.createElement('div');
                episodeItem.className = 'episode-item';
                episodeItem.innerHTML = `Серия ${ep.number}`;
                episodeItem.addEventListener('click', () => {
                    tg.openTelegramLink(ep.url);
                });
                
                episodesList.appendChild(episodeItem);
            });
            
            // Активируем вкладку с сериями
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            document.querySelector('.tab[data-tab="episodes"]').classList.add('active');
            document.getElementById('episodes-content').classList.add('active');
        }
        
        // Отображение закладок
        function renderBookmarks(statusFilter = 'all') {
            const bookmarksList = document.getElementById('bookmarks-list');
            bookmarksList.innerHTML = '';
            
            const filteredBookmarks = statusFilter === 'all' 
                ? appData.bookmarks 
                : appData.bookmarks.filter(b => b.status === statusFilter);
            
            if (filteredBookmarks.length === 0) {
                bookmarksList.innerHTML = '<div class="empty-text">Закладки не найдены</div>';
                return;
            }
            
            filteredBookmarks.forEach(bookmark => {
                const anime = appData.animeList.find(a => a.id === bookmark.animeId);
                if (!anime) return;
                
                const card = document.createElement('div');
                card.className = 'anime-card';
                card.dataset.id = anime.id;
                
                card.innerHTML = `
                    <img src="${anime.thumbnail}" class="anime-poster" alt="${anime.title}">
                    <div class="anime-content">
                        <h3 class="anime-title">${anime.title}</h3>
                        <div class="anime-genre">
                            ${anime.genres.map(genre => `<span class="genre-tag">${genre}</span>`).join('')}
                        </div>
                        <div class="anime-description">
                            Статус: <span class="featured-rating">${getStatusText(bookmark.status)}</span>
                        </div>
                        <button class="watch-btn">
                            ${bookmark.status === 'watched' ? 'Пересмотреть' : 
                              bookmark.status === 'planned' ? 'Начать смотреть' : 
                              'Продолжить'}
                        </button>
                    </div>
                `;
                
                bookmarksList.appendChild(card);
            });
            
            // Добавляем обработчики событий для карточек
            document.querySelectorAll('#bookmarks-list .anime-card').forEach(card => {
                card.addEventListener('click', (e) => {
                    if (e.target.classList.contains('watch-btn')) {
                        const animeId = parseInt(card.dataset.id);
                        showAnimeDetails(animeId);
                        showEpisodesTab();
                    } else {
                        const animeId = parseInt(card.dataset.id);
                        showAnimeDetails(animeId);
                    }
                });
            });
        }
        
        // Отображение календаря релизов в админ-панели
        function renderAdminCalendar() {
            const calendarDays = document.getElementById('calendar-days');
            const calendarReleases = document.getElementById('calendar-releases');
            
            calendarDays.innerHTML = '';
            calendarReleases.innerHTML = '';
            
            appData.calendar.forEach((day, index) => {
                const dayEl = document.createElement('div');
                dayEl.className = `calendar-day ${index === appData.currentDay ? 'active' : ''}`;
                dayEl.innerHTML = `
                    <div class="calendar-day-name">${day.dayName}</div>
                    <div class="calendar-day-date">${day.date.getDate()}</div>
                `;
                
                dayEl.addEventListener('click', () => {
                    appData.currentDay = index;
                    renderAdminCalendar();
                });
                
                calendarDays.appendChild(dayEl);
            });
            
            // Отображаем релизы для выбранного дня
            const currentDayData = appData.calendar[appData.currentDay];
            if (currentDayData.releases.length === 0) {
                calendarReleases.innerHTML = '<div class="empty-text">Нет релизов на выбранный день</div>';
                return;
            }
            
            currentDayData.releases.forEach(anime => {
                const releaseEl = document.createElement('div');
                releaseEl.className = 'anime-card';
                releaseEl.innerHTML = `
                    <img src="${anime.thumbnail}" class="anime-poster" alt="${anime.title}">
                    <div class="anime-content">
                        <h3 class="anime-title">${anime.title}</h3>
                        <div class="anime-genre">
                            ${anime.genres.map(g => `<span class="genre-tag">${g}</span>`).join('')}
                        </div>
                        <div class="anime-description">
                            Серий: ${anime.episodes.length} из ${anime.totalEpisodes}<br>
                            Статус: <span class="featured-rating">${getStatusText(anime.status)}</span>
                        </div>
                        <button class="watch-btn" data-action="edit" data-id="${anime.id}">Редактировать</button>
                    </div>
                `;
                
                calendarReleases.appendChild(releaseEl);
            });
            
            // Добавляем обработчики для кнопок редактирования
            document.querySelectorAll('[data-action="edit"]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const animeId = parseInt(btn.dataset.id);
                    navigateTo('adminEdit');
                    loadAnimeForEdit(animeId);
                });
            });
        }
        
        // Загрузка данных аниме для редактирования
        function loadAnimeForEdit(animeId) {
            const anime = appData.animeList.find(a => a.id === animeId);
            if (!anime) return;
            
            document.getElementById('anime-title').value = anime.title;
            document.getElementById('anime-eng-title').value = anime.engTitle;
            document.getElementById('anime-year').value = anime.year;
            document.getElementById('anime-status').value = anime.status;
            document.getElementById('anime-description').value = anime.description;
            document.getElementById('anime-genres').value = anime.genres.join(', ');
            document.getElementById('anime-season').value = anime.season;
            document.getElementById('anime-voices').value = anime.voices.map(v => `${v.name}:${v.link}`).join(', ');
            document.getElementById('anime-timing').value = anime.timing;
            document.getElementById('anime-image').value = anime.image;
            document.getElementById('anime-thumbnail').value = anime.thumbnail;
            document.getElementById('anime-total-episodes').value = anime.totalEpisodes;
            
            // Загрузка серий
            const episodesContainer = document.getElementById('episodes-container');
            episodesContainer.innerHTML = '';
            
            anime.episodes.forEach(ep => {
                const episodeEl = document.createElement('div');
                episodeEl.className = 'form-group';
                episodeEl.innerHTML = `
                    <label class="form-label">Серия ${ep.number}</label>
                    <input type="text" class="form-input" value="${ep.url}" data-number="${ep.number}">
                    <div class="episode-controls">
                        <button class="admin-btn" data-action="save-episode" data-number="${ep.number}">Сохранить</button>
                        <button class="admin-btn remove-btn" data-action="remove-episode" data-number="${ep.number}">Удалить</button>
                    </div>
                `;
                
                episodesContainer.appendChild(episodeEl);
            });
            
            // Добавляем обработчики для кнопок управления сериями
            document.querySelectorAll('[data-action="save-episode"]').forEach(btn => {
                btn.addEventListener('click', () => {
                    const number = parseInt(btn.dataset.number);
                    const url = document.querySelector(`input[data-number="${number}"]`).value;
                    saveEpisode(number, url);
                });
            });
            
            document.querySelectorAll('[data-action="remove-episode"]').forEach(btn => {
                btn.addEventListener('click', () => {
                    const number = parseInt(btn.dataset.number);
                    removeEpisode(number);
                });
            });
        }
        
        // Сохранение серии
        function saveEpisode(number, url) {
            if (!appData.currentAnime) return;
            
            const episodeIndex = appData.currentAnime.episodes.findIndex(ep => ep.number === number);
            
            if (episodeIndex >= 0) {
                appData.currentAnime.episodes[episodeIndex].url = url;
            } else {
                appData.currentAnime.episodes.push({number, url});
            }
            
            alert('Серия сохранена');
        }
        
        // Удаление серии
        function removeEpisode(number) {
            if (!appData.currentAnime) return;
            
            appData.currentAnime.episodes = appData.currentAnime.episodes.filter(ep => ep.number !== number);
            loadAnimeForEdit(appData.currentAnime.id);
            alert('Серия удалена');
        }
        
        // Отображение заблокированных пользователей
        function renderBannedUsers() {
            const bannedUsersContainer = document.getElementById('banned-users');
            bannedUsersContainer.innerHTML = '';
            
            if (appData.bannedUsers.length === 0) {
                bannedUsersContainer.innerHTML = '<p>Нет заблокированных пользователей</p>';
                return;
            }
            
            appData.bannedUsers.forEach(username => {
                const userEl = document.createElement('div');
                userEl.className = 'banned-user';
                userEl.innerHTML = `
                    <div class="banned-username">@${username}</div>
                    <button class="unban-btn" data-username="${username}">Разблокировать</button>
                `;
                
                bannedUsersContainer.appendChild(userEl);
            });
            
            // Добавляем обработчики для кнопок разблокировки
            document.querySelectorAll('.unban-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const username = btn.dataset.username;
                    unbanUser(username);
                });
            });
        }
        
        // Блокировка пользователя
        function banUser(username) {
            if (!username.startsWith('@')) {
                username = '@' + username;
            }
            
            if (appData.bannedUsers.includes(username)) {
                alert('Пользователь уже заблокирован');
                return;
            }
            
            appData.bannedUsers.push(username);
            renderBannedUsers();
            alert(`Пользователь ${username} заблокирован`);
        }
        
        // Разблокировка пользователя
        function unbanUser(username) {
            appData.bannedUsers = appData.bannedUsers.filter(u => u !== username);
            renderBannedUsers();
            alert(`Пользователь ${username} разблокирован`);
        }
        
        // Отображение комментариев для управления
        function renderCommentsForManage() {
            const commentsContainer = document.getElementById('comment-manage');
            commentsContainer.innerHTML = '';
            
            if (appData.comments.length === 0) {
                commentsContainer.innerHTML = '<p>Комментарии не найдены</p>';
                return;
            }
            
            // Показываем последние 10 комментариев
            const recentComments = [...appData.comments].reverse().slice(0, 10);
            
            recentComments.forEach(comment => {
                const anime = appData.animeList.find(a => a.id === comment.animeId);
                if (!anime) return;
                
                const commentEl = document.createElement('div');
                commentEl.className = 'comment-item';
                commentEl.innerHTML = `
                    <div class="comment-meta">
                        <div class="comment-user-info">
                            <img src="${comment.avatar}" class="comment-avatar" alt="Аватар">
                            <div>
                                <div class="comment-user">${comment.username}</div>
                                <div class="comment-date">${comment.date}</div>
                            </div>
                        </div>
                        <div class="comment-actions-admin">
                            <button class="delete-comment-btn" data-id="${comment.id}">Удалить</button>
                            ${appData.bannedUsers.includes(comment.username) ? '' : 
                              `<button class="admin-btn" data-action="ban" data-username="${comment.username}">Блок</button>`}
                        </div>
                    </div>
                    <div class="comment-text">
                        <strong>${anime.title}</strong><br>
                        ${comment.text}
                    </div>
                `;
                
                commentsContainer.appendChild(commentEl);
            });
            
            // Добавляем обработчики для кнопок управления
            document.querySelectorAll('.delete-comment-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const commentId = parseInt(btn.dataset.id);
                    deleteComment(commentId);
                });
            });
            
            document.querySelectorAll('[data-action="ban"]').forEach(btn => {
                btn.addEventListener('click', () => {
                    const username = btn.dataset.username;
                    banUser(username);
                });
            });
        }
        
        // Удаление комментария
        function deleteComment(commentId) {
            appData.comments = appData.comments.filter(c => c.id !== commentId);
            renderCommentsForManage();
            alert('Комментарий удален');
        }
        
        // Навигация
        function navigateTo(pageId) {
            // Скрыть все страницы
            Object.values(elements.pages).forEach(page => {
                page.classList.remove('active');
            });
            
            // Показать целевую страницу
            if (elements.pages[pageId]) {
                elements.pages[pageId].classList.add('active');
                
                // При переходе на определенные страницы выполняем дополнительные действия
                switch (pageId) {
                    case 'bookmarks':
                        renderBookmarks();
                        break;
                    case 'adminReleases':
                        renderAdminCalendar();
                        break;
                    case 'adminComments':
                        renderBannedUsers();
                        renderCommentsForManage();
                        break;
                }
            }
            
            // Скрыть оверлей и меню
            elements.overlay.classList.remove('active');
            elements.centerMenu.classList.remove('active');
            elements.searchPanel.classList.remove('active');
        }

        // Обновление точек горизонтального скролла
        function updateDots() {
            const scrollLeft = elements.featuredScroll.scrollLeft;
            const cardWidth = elements.featuredScroll.querySelector('.featured-card')?.offsetWidth || 0;
            if (cardWidth === 0) return;
            
            const activeIndex = Math.round(scrollLeft / cardWidth);
            
            elements.dotsContainer.querySelectorAll('.dot').forEach((dot, index) => {
                dot.classList.toggle('active', index === activeIndex);
            });
        }

        // Прокрутка к определенной карточке
        function scrollToCard(index) {
            const cardWidth = elements.featuredScroll.querySelector('.featured-card')?.offsetWidth || 0;
            if (cardWidth === 0) return;
            
            elements.featuredScroll.scrollTo({
                left: cardWidth * index,
                behavior: 'smooth'
            });
        }
        
        // Загрузка сохраненной темы
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'classic';
            document.body.className = savedTheme + '-theme';
            
            // Активировать соответствующую кнопку
            document.querySelectorAll('.theme-option').forEach(option => {
                if (option.dataset.theme === savedTheme) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
        }
        
        // Настройка обработчиков событий
        function setupEventListeners() {
            // Аватарка пользователя
            elements.avatar.addEventListener('click', () => {
                elements.centerMenu.classList.toggle('active');
                elements.overlay.classList.toggle('active');
            });
            
            // Иконка поиска
            elements.searchIcon.addEventListener('click', () => {
                elements.searchPanel.classList.toggle('active');
                elements.overlay.classList.toggle('active');
            });
            
            // Переключение фильтров
            elements.filterToggle.addEventListener('click', () => {
                elements.filterToggle.classList.toggle('active');
                elements.filters.classList.toggle('active');
            });
            
            // Кнопка закладки
            elements.bookmarkBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                elements.bookmarkMenu.classList.toggle('active');
            });
            
            // Выбор статуса закладки
            document.querySelectorAll('.bookmark-option').forEach(option => {
                option.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const status = option.dataset.status;
                    
                    if (!appData.currentAnime) return;
                    
                    // Обновляем данные закладки
                    const existingIndex = appData.bookmarks.findIndex(b => b.animeId === appData.currentAnime.id);
                    
                    if (existingIndex >= 0) {
                        // Обновляем существующую закладку
                        appData.bookmarks[existingIndex].status = status;
                    } else {
                        // Добавляем новую закладку
                        appData.bookmarks.push({
                            animeId: appData.currentAnime.id,
                            status: status,
                            lastWatchedEpisode: 0
                        });
                    }
                    
                    // Обновляем счетчики в профиле
                    updateProfileCounters();
                    
                    // Изменяем иконку закладки
                    const bookmarkIcon = elements.bookmarkBtn.querySelector('svg path');
                    bookmarkIcon.setAttribute('fill', '#FF6B81');
                    
                    elements.bookmarkMenu.classList.remove('active');
                });
            });
            
            // Закрытие меню закладок при клике вне его
            document.addEventListener('click', () => {
                elements.bookmarkMenu.classList.remove('active');
            });
            
            // Кнопка назад в деталях
            document.querySelector('.back-btn').addEventListener('click', () => {
                elements.detailPage.classList.remove('active');
            });
            
            // Вкладки
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // Переключение контента вкладок
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`${tab.dataset.tab}-content`).classList.add('active');
                });
            });
            
            // Фильтры
            document.querySelectorAll('.filter-option').forEach(option => {
                option.addEventListener('click', () => {
                    option.classList.toggle('active');
                });
            });
            
            // Оверлей
            elements.overlay.addEventListener('click', () => {
                elements.centerMenu.classList.remove('active');
                elements.searchPanel.classList.remove('active');
                elements.overlay.classList.remove('active');
            });
            
            // Горизонтальный скролл с точками
            elements.featuredScroll.addEventListener('scroll', () => {
                updateDots();
            });
            
            // Фильтры закладок
            document.querySelectorAll('.bookmark-filter').forEach(filter => {
                filter.addEventListener('click', () => {
                    document.querySelectorAll('.bookmark-filter').forEach(f => f.classList.remove('active'));
                    filter.classList.add('active');
                    
                    const status = filter.dataset.status;
                    renderBookmarks(status);
                });
            });
            
            // Навигация в меню
            document.querySelectorAll('.menu-items li').forEach(item => {
                item.addEventListener('click', () => {
                    const pageId = item.dataset.page;
                    navigateTo(pageId);
                });
            });
            
            // Кнопки "назад"
            document.querySelectorAll('.back-icon').forEach(btn => {
                btn.addEventListener('click', () => {
                    const targetPage = btn.dataset.back;
                    navigateTo(targetPage);
                });
            });
            
            // Выбор темы
            document.querySelectorAll('.theme-option').forEach(option => {
                option.addEventListener('click', () => {
                    // Удалить активный класс у всех
                    document.querySelectorAll('.theme-option').forEach(opt => {
                        opt.classList.remove('active');
                    });
                    
                    // Добавить активный класс текущему
                    option.classList.add('active');
                    
                    // Установить тему
                    const theme = option.dataset.theme;
                    document.body.className = theme + '-theme';
                    
                    // Сохранить выбор
                    localStorage.setItem('theme', theme);
                });
            });
            
            // Вход в админ-панель
            document.getElementById('admin-login-btn').addEventListener('click', () => {
                const login = document.getElementById('admin-login').value;
                const password = document.getElementById('admin-password').value;
                
                if (login === 'DiZav' && password === 'Z@vD1love') {
                    navigateTo('adminMain');
                } else {
                    alert('Неверный логин или пароль!');
                }
            });
            
            // Навигация в админ-панели
            document.querySelectorAll('.admin-menu-item').forEach(item => {
                item.addEventListener('click', () => {
                    const pageId = item.dataset.page;
                    navigateTo(pageId);
                });
            });
            
            // Кнопка "Смотреть" в деталях
            document.getElementById('watch-btn').addEventListener('click', () => {
                showEpisodesTab();
            });
            
            // Кнопки навигации по неделям в календаре
            document.getElementById('prev-week').addEventListener('click', () => {
                // В реальном приложении здесь будет загрузка данных предыдущей недели
                alert('Загрузка данных предыдущей недели');
            });
            
            document.getElementById('next-week').addEventListener('click', () => {
                // В реальном приложении здесь будет загрузка данных следующей недели
                alert('Загрузка данных следующей недели');
            });
            
            // Кнопка добавления релиза
            document.getElementById('add-release-btn').addEventListener('click', () => {
                navigateTo('adminEdit');
                // Сброс формы для нового тайтла
                document.getElementById('anime-title').value = '';
                document.getElementById('anime-eng-title').value = '';
                document.getElementById('anime-year').value = '';
                document.getElementById('anime-status').value = 'planned';
                document.getElementById('anime-description').value = '';
                document.getElementById('anime-genres').value = '';
                document.getElementById('anime-season').value = '';
                document.getElementById('anime-voices').value = '';
                document.getElementById('anime-timing').value = '';
                document.getElementById('anime-image').value = '';
                document.getElementById('anime-thumbnail').value = '';
                document.getElementById('anime-total-episodes').value = '';
                document.getElementById('episodes-container').innerHTML = '';
            });
            
            // Кнопка добавления серии
            document.getElementById('add-episode-btn').addEventListener('click', () => {
                const number = parseInt(document.getElementById('new-episode-number').value);
                const url = document.getElementById('new-episode-url').value;
                
                if (!number || !url) {
                    alert('Заполните номер серии и URL');
                    return;
                }
                
                saveEpisode(number, url);
                loadAnimeForEdit(appData.currentAnime.id);
                
                // Очищаем поля
                document.getElementById('new-episode-number').value = '';
                document.getElementById('new-episode-url').value = '';
            });
            
            // Кнопка сохранения тайтла
            document.getElementById('save-anime-btn').addEventListener('click', () => {
                // В реальном приложении здесь будет сохранение данных
                alert('Изменения сохранены');
            });
            
            // Кнопка удаления тайтла
            document.getElementById('delete-anime-btn').addEventListener('click', () => {
                if (confirm('Вы уверены, что хотите удалить этот тайтл?')) {
                    // В реальном приложении здесь будет удаление
                    alert('Тайтл удален');
                    navigateTo('adminReleases');
                }
            });
            
            // Кнопка блокировки пользователя
            document.getElementById('ban-user-btn').addEventListener('click', () => {
                const username = document.getElementById('ban-username').value.trim();
                if (!username) {
                    alert('Введите юзернейм');
                    return;
                }
                
                banUser(username);
                document.getElementById('ban-username').value = '';
            });
            
            // Отправка комментария
            document.getElementById('comment-submit').addEventListener('click', () => {
                const commentText = document.getElementById('comment-input').value.trim();
                if (!commentText) {
                    alert('Введите текст комментария');
                    return;
                }
                
                if (!appData.currentAnime) {
                    alert('Ошибка: не выбран тайтл');
                    return;
                }
                
                // Проверка на блокировку
                if (appData.bannedUsers.includes(user.username)) {
                    alert('Вы заблокированы и не можете оставлять комментарии');
                    return;
                }
                
                // Добавляем комментарий
                const newComment = {
                    id: Date.now(),
                    animeId: appData.currentAnime.id,
                    userId: user.id,
                    username: user.username,
                    avatar: user.photo_url,
                    text: commentText,
                    date: 'Только что',
                    likes: 0,
                    dislikes: 0
                };
                
                appData.comments.push(newComment);
                
                // Обновляем счетчик комментариев в профиле
                updateProfileCounters();
                
                // Очищаем поле ввода
                document.getElementById('comment-input').value = '';
                
                // Обновляем список комментариев
                renderComments();
                
                alert('Комментарий добавлен');
            });
            
            // Оценка аниме
            document.querySelectorAll('.star').forEach(star => {
                star.addEventListener('click', () => {
                    const rating = parseInt(star.dataset.rating);
                    
                    // Устанавливаем активные звезды
                    document.querySelectorAll('.star').forEach((s, i) => {
                        if (i < rating) {
                            s.classList.add('active');
                        } else {
                            s.classList.remove('active');
                        }
                    });
                    
                    // В реальном приложении здесь будет сохранение оценки
                    alert(`Вы поставили оценку: ${rating}`);
                });
            });
        }
        
        // Запуск приложения
        document.addEventListener('DOMContentLoaded', () => {
            initData();
            setupUserData();
            renderAnimeList();
            renderFeaturedAnime();
            setupEventListeners();
            loadTheme();
            updateDots(); // Инициализация точек
            
            // Заполняем выпадающий список тайтлов в админке
            const animeSelect = document.getElementById('anime-select');
            appData.animeList.forEach(anime => {
                const option = document.createElement('option');
                option.value = anime.id;
                option.textContent = anime.title;
                animeSelect.appendChild(option);
            });
            
            // Обработчик изменения выбора тайтла в админке
            animeSelect.addEventListener('change', () => {
                const animeId = parseInt(animeSelect.value);
                if (animeId) {
                    loadAnimeForEdit(animeId);
                }
            });
        });
    </script>
</body>
</html>
